---
inherit: manifest_base.yml
instances: 2

# Unfortunately, these configs needs to be repeated across dev/prod. Can be
# fixed by using different domains
applications:
  - name: api
    buildpack: python_buildpack
    services:
      - database  # aws-rds medium-psql
      - config    # user-provided service w/ DJANGO_SECRET_KEY and NEW_RELIC_LICENSE_KEY
    command: ./devops/run_api.sh
    host: omb-eregs-api
    env:
      NEW_RELIC_APP_NAME: OMB Prod API/Admin
      MAX_URL: https://login.max.gov/cas/login
  - name: ui
    buildpack: nodejs_buildpack
    command: node ui-dist/server.js
    host: omb-eregs
    services:
      - config    # user-provided service w/ UI_BASIC_AUTH and NEW_RELIC_LICENSE_KEY
    env:
      INTERNAL_API: https://omb-eregs-api.app.cloud.gov/
      PUBLIC_API: https://omb-eregs-api.app.cloud.gov/
      NEW_RELIC_APP_NAME: OMB Prod UI
